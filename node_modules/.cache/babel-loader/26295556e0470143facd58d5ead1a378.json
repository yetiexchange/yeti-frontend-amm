{"ast":null,"code":"var _jsxFileName = \"H:\\\\XETI\\\\YETI-AMM-DEV\\\\src\\\\components\\\\SearchModal\\\\ListSelect.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { memo, useCallback, useMemo, useRef, useState } from 'react';\nimport { ArrowLeft } from 'react-feather';\nimport { usePopper } from 'react-popper';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Button, Text } from '@pancakeswap-libs/uikit';\nimport styled from 'styled-components';\nimport { ReactComponent as DropDown } from \"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/images/dropdown.svg\";\nimport { useFetchListCallback } from '../../hooks/useFetchListCallback';\nimport { useOnClickOutside } from '../../hooks/useOnClickOutside';\nimport useToggle from '../../hooks/useToggle';\nimport { acceptListUpdate, removeList, selectList } from '../../state/lists/actions';\nimport { useSelectedListUrl } from '../../state/lists/hooks';\nimport { CloseIcon, ExternalLink, LinkStyledButton, TYPE } from '../Shared';\nimport listVersionLabel from '../../utils/listVersionLabel';\nimport { parseENSAddress } from '../../utils/parseENSAddress';\nimport uriToHttp from '../../utils/uriToHttp';\nimport Column from '../Column';\nimport ListLogo from '../ListLogo';\nimport QuestionHelper from '../QuestionHelper';\nimport Row, { RowBetween } from '../Row';\nimport { PaddedColumn, SearchInput, Separator, SeparatorDark } from './styleds';\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  error: Error\n} = TYPE;\nconst UnpaddedLinkStyledButton = styled(LinkStyledButton)`\n  padding: 0;\n  font-size: 1rem;\n  opacity: ${({\n  disabled\n}) => disabled ? '0.4' : '1'};\n`;\n_c = UnpaddedLinkStyledButton;\nconst PopoverContainer = styled.div`\n  z-index: 100;\n  visibility: ${props => props.show ? 'visible' : 'hidden'};\n  opacity: ${props => props.show ? 1 : 0};\n  transition: visibility 150ms linear, opacity 150ms linear;\n  background: ${({\n  theme\n}) => theme.colors.invertedContrast};\n  border: 1px solid ${({\n  theme\n}) => theme.colors.tertiary};\n  box-shadow: 0px 0px 1px rgba(0, 0, 0, 0.01), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04),\n    0px 24px 32px rgba(0, 0, 0, 0.01);\n  color: ${({\n  theme\n}) => theme.colors.textSubtle};\n  border-radius: 0.5rem;\n  padding: 1rem;\n  display: grid;\n  grid-template-rows: 1fr;\n  grid-gap: 8px;\n  font-size: 1rem;\n  text-align: left;\n`;\n_c2 = PopoverContainer;\nconst StyledMenu = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n  border: none;\n`;\n_c3 = StyledMenu;\nconst StyledListUrlText = styled.div`\n  max-width: 160px;\n  opacity: 0.6;\n  margin-right: 0.5rem;\n  font-size: 14px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n_c4 = StyledListUrlText;\n\nfunction ListOrigin({\n  listUrl\n}) {\n  _s();\n\n  const ensName = useMemo(() => {\n    var _parseENSAddress;\n\n    return (_parseENSAddress = parseENSAddress(listUrl)) === null || _parseENSAddress === void 0 ? void 0 : _parseENSAddress.ensName;\n  }, [listUrl]);\n  const host = useMemo(() => {\n    if (ensName) return undefined;\n    const lowerListUrl = listUrl.toLowerCase();\n\n    if (lowerListUrl.startsWith('ipfs://') || lowerListUrl.startsWith('ipns://')) {\n      return listUrl;\n    }\n\n    try {\n      const url = new URL(listUrl);\n      return url.host;\n    } catch (error) {\n      return undefined;\n    }\n  }, [listUrl, ensName]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: ensName !== null && ensName !== void 0 ? ensName : host\n  }, void 0, false);\n}\n\n_s(ListOrigin, \"SxtAwdTxOPoU+UHqf6mYStIkrko=\");\n\n_c5 = ListOrigin;\n\nfunction listUrlRowHTMLId(listUrl) {\n  return `list-row-${listUrl.replace(/\\./g, '-')}`;\n}\n\nconst ListRow = /*#__PURE__*/memo(_c6 = _s2(function ListRow({\n  listUrl,\n  onBack\n}) {\n  _s2();\n\n  const listsByUrl = useSelector(state => state.lists.byUrl);\n  const selectedListUrl = useSelectedListUrl();\n  const dispatch = useDispatch();\n  const {\n    current: list,\n    pendingUpdate: pending\n  } = listsByUrl[listUrl];\n  const isSelected = listUrl === selectedListUrl;\n  const [open, toggle] = useToggle(false);\n  const node = useRef();\n  const [referenceElement, setReferenceElement] = useState();\n  const [popperElement, setPopperElement] = useState();\n  const {\n    styles,\n    attributes\n  } = usePopper(referenceElement, popperElement, {\n    placement: 'auto',\n    strategy: 'fixed',\n    modifiers: [{\n      name: 'offset',\n      options: {\n        offset: [8, 8]\n      }\n    }]\n  });\n  useOnClickOutside(node, open ? toggle : undefined);\n  const selectThisList = useCallback(() => {\n    if (isSelected) return;\n    dispatch(selectList(listUrl));\n    onBack();\n  }, [dispatch, isSelected, listUrl, onBack]);\n  const handleAcceptListUpdate = useCallback(() => {\n    if (!pending) return;\n    dispatch(acceptListUpdate(listUrl));\n  }, [dispatch, listUrl, pending]);\n  const handleRemoveList = useCallback(() => {\n    if (window.prompt(`Please confirm you would like to remove this list by typing REMOVE`) === `REMOVE`) {\n      dispatch(removeList(listUrl));\n    }\n  }, [dispatch, listUrl]);\n  if (!list) return null;\n  return /*#__PURE__*/_jsxDEV(Row, {\n    align: \"center\",\n    padding: \"16px\",\n    id: listUrlRowHTMLId(listUrl),\n    children: [list.logoURI ? /*#__PURE__*/_jsxDEV(ListLogo, {\n      style: {\n        marginRight: '1rem'\n      },\n      logoURI: list.logoURI,\n      alt: `${list.name} list logo`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: '24px',\n        height: '24px',\n        marginRight: '1rem'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Column, {\n      style: {\n        flex: '1'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Text, {\n          bold: isSelected,\n          fontSize: \"16px\",\n          style: {\n            overflow: 'hidden',\n            textOverflow: 'ellipsis'\n          },\n          children: list.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        style: {\n          marginTop: '4px'\n        },\n        children: /*#__PURE__*/_jsxDEV(StyledListUrlText, {\n          title: listUrl,\n          children: /*#__PURE__*/_jsxDEV(ListOrigin, {\n            listUrl: listUrl\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(StyledMenu, {\n      ref: node,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'inline-block'\n        },\n        ref: setReferenceElement,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          style: {\n            width: '32px',\n            marginRight: '8px'\n          },\n          onClick: toggle,\n          variant: \"secondary\",\n          children: /*#__PURE__*/_jsxDEV(DropDown, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this), open && /*#__PURE__*/_jsxDEV(PopoverContainer, {\n        show: true,\n        ref: setPopperElement,\n        style: styles.popper,\n        ...attributes.popper,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: list && listVersionLabel(list.version)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(SeparatorDark, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ExternalLink, {\n          href: `https://tokenlists.org/token-list?url=${listUrl}`,\n          children: \"View list\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(UnpaddedLinkStyledButton, {\n          onClick: handleRemoveList,\n          disabled: Object.keys(listsByUrl).length === 1,\n          children: \"Remove list\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 13\n        }, this), pending && /*#__PURE__*/_jsxDEV(UnpaddedLinkStyledButton, {\n          onClick: handleAcceptListUpdate,\n          children: \"Update list\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }, this), isSelected ? /*#__PURE__*/_jsxDEV(Button, {\n      disabled: true,\n      style: {\n        width: '5rem',\n        minWidth: '5rem'\n      },\n      children: \"Selected\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        className: \"select-button\",\n        style: {\n          width: '5rem',\n          minWidth: '4.5rem'\n        },\n        onClick: selectThisList,\n        children: \"Select\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 11\n      }, this)\n    }, void 0, false)]\n  }, listUrl, true, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 5\n  }, this);\n}, \"uzaNpPm/bOWMxoYUl6utOd4w8HQ=\", false, function () {\n  return [useSelector, useSelectedListUrl, useDispatch, useToggle, usePopper, useOnClickOutside];\n}));\n_c7 = ListRow;\nconst ListContainer = styled.div`\n  flex: 1;\n  overflow: auto;\n`;\n_c8 = ListContainer;\nexport function ListSelect({\n  onDismiss,\n  onBack\n}) {\n  _s3();\n\n  var _lists$listUrlInput;\n\n  const [listUrlInput, setListUrlInput] = useState('');\n  const dispatch = useDispatch();\n  const lists = useSelector(state => state.lists.byUrl);\n  const adding = Boolean((_lists$listUrlInput = lists[listUrlInput]) === null || _lists$listUrlInput === void 0 ? void 0 : _lists$listUrlInput.loadingRequestId);\n  const [addError, setAddError] = useState(null);\n  const handleInput = useCallback(e => {\n    setListUrlInput(e.target.value);\n    setAddError(null);\n  }, []);\n  const fetchList = useFetchListCallback();\n  const handleAddList = useCallback(() => {\n    if (adding) return;\n    setAddError(null);\n    fetchList(listUrlInput).then(() => {\n      setListUrlInput('');\n    }).catch(error => {\n      setAddError(error.message);\n      dispatch(removeList(listUrlInput));\n    });\n  }, [adding, dispatch, fetchList, listUrlInput]);\n  const validUrl = useMemo(() => {\n    return uriToHttp(listUrlInput).length > 0 || Boolean(parseENSAddress(listUrlInput));\n  }, [listUrlInput]);\n  const handleEnterKey = useCallback(e => {\n    if (validUrl && e.key === 'Enter') {\n      handleAddList();\n    }\n  }, [handleAddList, validUrl]);\n  const sortedLists = useMemo(() => {\n    const listUrls = Object.keys(lists);\n    return listUrls.filter(listUrl => {\n      return Boolean(lists[listUrl].current);\n    }).sort((u1, u2) => {\n      const {\n        current: l1\n      } = lists[u1];\n      const {\n        current: l2\n      } = lists[u2];\n\n      if (l1 && l2) {\n        return l1.name.toLowerCase() < l2.name.toLowerCase() ? -1 : l1.name.toLowerCase() === l2.name.toLowerCase() ? 0 : 1;\n      }\n\n      if (l1) return -1;\n      if (l2) return 1;\n      return 0;\n    });\n  }, [lists]);\n  return /*#__PURE__*/_jsxDEV(Column, {\n    style: {\n      width: '100%',\n      flex: '1 1'\n    },\n    children: [/*#__PURE__*/_jsxDEV(PaddedColumn, {\n      children: /*#__PURE__*/_jsxDEV(RowBetween, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(ArrowLeft, {\n            style: {\n              cursor: 'pointer'\n            },\n            onClick: onBack\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Text, {\n          fontSize: \"20px\",\n          children: \"Manage Lists\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CloseIcon, {\n          onClick: onDismiss\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Separator, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PaddedColumn, {\n      gap: \"14px\",\n      children: [/*#__PURE__*/_jsxDEV(Text, {\n        bold: true,\n        children: [\"Add a list\", ' ', /*#__PURE__*/_jsxDEV(QuestionHelper, {\n          text: \"Token lists are an open specification for lists of BEP20 tokens. You can use any token list by entering its URL below. Beware that third party token lists can contain fake or malicious BEP20 tokens.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(SearchInput, {\n          type: \"text\",\n          id: \"list-add-input\",\n          placeholder: \"https:// or ipfs:// or ENS name\",\n          value: listUrlInput,\n          onChange: handleInput,\n          onKeyDown: handleEnterKey,\n          style: {\n            height: '2.75rem',\n            borderRadius: 12,\n            padding: '12px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleAddList,\n          style: {\n            maxWidth: '4em',\n            marginLeft: '1em'\n          },\n          disabled: !validUrl,\n          children: \"Add\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 9\n      }, this), addError ? /*#__PURE__*/_jsxDEV(Error, {\n        title: addError,\n        style: {\n          textOverflow: 'ellipsis',\n          overflow: 'hidden'\n        },\n        error: true,\n        children: addError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 11\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Separator, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ListContainer, {\n      children: sortedLists.map(listUrl => /*#__PURE__*/_jsxDEV(ListRow, {\n        listUrl: listUrl,\n        onBack: onBack\n      }, listUrl, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Separator, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '16px',\n        textAlign: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(ExternalLink, {\n        href: \"https://tokenlists.org\",\n        children: \"Browse lists\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 273,\n    columnNumber: 5\n  }, this);\n}\n\n_s3(ListSelect, \"/hgRDerya3FeypPOkWUTZaPmKAM=\", false, function () {\n  return [useDispatch, useSelector, useFetchListCallback];\n});\n\n_c9 = ListSelect;\nexport default ListSelect;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9;\n\n$RefreshReg$(_c, \"UnpaddedLinkStyledButton\");\n$RefreshReg$(_c2, \"PopoverContainer\");\n$RefreshReg$(_c3, \"StyledMenu\");\n$RefreshReg$(_c4, \"StyledListUrlText\");\n$RefreshReg$(_c5, \"ListOrigin\");\n$RefreshReg$(_c6, \"ListRow$memo\");\n$RefreshReg$(_c7, \"ListRow\");\n$RefreshReg$(_c8, \"ListContainer\");\n$RefreshReg$(_c9, \"ListSelect\");","map":{"version":3,"sources":["H:/XETI/YETI-AMM-DEV/src/components/SearchModal/ListSelect.tsx"],"names":["React","memo","useCallback","useMemo","useRef","useState","ArrowLeft","usePopper","useDispatch","useSelector","Button","Text","styled","useFetchListCallback","useOnClickOutside","useToggle","acceptListUpdate","removeList","selectList","useSelectedListUrl","CloseIcon","ExternalLink","LinkStyledButton","TYPE","listVersionLabel","parseENSAddress","uriToHttp","Column","ListLogo","QuestionHelper","Row","RowBetween","PaddedColumn","SearchInput","Separator","SeparatorDark","error","Error","UnpaddedLinkStyledButton","disabled","PopoverContainer","div","props","show","theme","colors","invertedContrast","tertiary","textSubtle","StyledMenu","StyledListUrlText","ListOrigin","listUrl","ensName","host","undefined","lowerListUrl","toLowerCase","startsWith","url","URL","listUrlRowHTMLId","replace","ListRow","onBack","listsByUrl","state","lists","byUrl","selectedListUrl","dispatch","current","list","pendingUpdate","pending","isSelected","open","toggle","node","referenceElement","setReferenceElement","popperElement","setPopperElement","styles","attributes","placement","strategy","modifiers","name","options","offset","selectThisList","handleAcceptListUpdate","handleRemoveList","window","prompt","logoURI","marginRight","width","height","flex","overflow","textOverflow","marginTop","display","popper","version","Object","keys","length","minWidth","ListContainer","ListSelect","onDismiss","listUrlInput","setListUrlInput","adding","Boolean","loadingRequestId","addError","setAddError","handleInput","e","target","value","fetchList","handleAddList","then","catch","message","validUrl","handleEnterKey","key","sortedLists","listUrls","filter","sort","u1","u2","l1","l2","cursor","borderRadius","padding","maxWidth","marginLeft","map","textAlign"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useMemo, useRef, useState } from 'react'\nimport { ArrowLeft } from 'react-feather'\nimport { usePopper } from 'react-popper'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Button, Text } from '@pancakeswap-libs/uikit'\nimport styled from 'styled-components'\nimport { ReactComponent as DropDown } from '../../assets/images/dropdown.svg'\nimport { useFetchListCallback } from '../../hooks/useFetchListCallback'\nimport { useOnClickOutside } from '../../hooks/useOnClickOutside'\n\nimport useToggle from '../../hooks/useToggle'\nimport { AppDispatch, AppState } from '../../state'\nimport { acceptListUpdate, removeList, selectList } from '../../state/lists/actions'\nimport { useSelectedListUrl } from '../../state/lists/hooks'\nimport { CloseIcon, ExternalLink, LinkStyledButton, TYPE } from '../Shared'\nimport listVersionLabel from '../../utils/listVersionLabel'\nimport { parseENSAddress } from '../../utils/parseENSAddress'\nimport uriToHttp from '../../utils/uriToHttp'\nimport Column from '../Column'\nimport ListLogo from '../ListLogo'\nimport QuestionHelper from '../QuestionHelper'\nimport Row, { RowBetween } from '../Row'\nimport { PaddedColumn, SearchInput, Separator, SeparatorDark } from './styleds'\n\nconst { error: Error } = TYPE\n\nconst UnpaddedLinkStyledButton = styled(LinkStyledButton)`\n  padding: 0;\n  font-size: 1rem;\n  opacity: ${({ disabled }) => (disabled ? '0.4' : '1')};\n`\n\nconst PopoverContainer = styled.div<{ show: boolean }>`\n  z-index: 100;\n  visibility: ${(props) => (props.show ? 'visible' : 'hidden')};\n  opacity: ${(props) => (props.show ? 1 : 0)};\n  transition: visibility 150ms linear, opacity 150ms linear;\n  background: ${({ theme }) => theme.colors.invertedContrast};\n  border: 1px solid ${({ theme }) => theme.colors.tertiary};\n  box-shadow: 0px 0px 1px rgba(0, 0, 0, 0.01), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04),\n    0px 24px 32px rgba(0, 0, 0, 0.01);\n  color: ${({ theme }) => theme.colors.textSubtle};\n  border-radius: 0.5rem;\n  padding: 1rem;\n  display: grid;\n  grid-template-rows: 1fr;\n  grid-gap: 8px;\n  font-size: 1rem;\n  text-align: left;\n`\n\nconst StyledMenu = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n  border: none;\n`\n\nconst StyledListUrlText = styled.div`\n  max-width: 160px;\n  opacity: 0.6;\n  margin-right: 0.5rem;\n  font-size: 14px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`\n\nfunction ListOrigin({ listUrl }: { listUrl: string }) {\n  const ensName = useMemo(() => parseENSAddress(listUrl)?.ensName, [listUrl])\n  const host = useMemo(() => {\n    if (ensName) return undefined\n    const lowerListUrl = listUrl.toLowerCase()\n    if (lowerListUrl.startsWith('ipfs://') || lowerListUrl.startsWith('ipns://')) {\n      return listUrl\n    }\n    try {\n      const url = new URL(listUrl)\n      return url.host\n    } catch (error) {\n      return undefined\n    }\n  }, [listUrl, ensName])\n  return <>{ensName ?? host}</>\n}\n\nfunction listUrlRowHTMLId(listUrl: string) {\n  return `list-row-${listUrl.replace(/\\./g, '-')}`\n}\n\nconst ListRow = memo(function ListRow({ listUrl, onBack }: { listUrl: string; onBack: () => void }) {\n  const listsByUrl = useSelector<AppState, AppState['lists']['byUrl']>((state) => state.lists.byUrl)\n  const selectedListUrl = useSelectedListUrl()\n  const dispatch = useDispatch<AppDispatch>()\n  const { current: list, pendingUpdate: pending } = listsByUrl[listUrl]\n\n  const isSelected = listUrl === selectedListUrl\n\n  const [open, toggle] = useToggle(false)\n  const node = useRef<HTMLDivElement>()\n  const [referenceElement, setReferenceElement] = useState<HTMLDivElement | null>()\n  const [popperElement, setPopperElement] = useState<HTMLDivElement>()\n\n  const { styles, attributes } = usePopper(referenceElement, popperElement, {\n    placement: 'auto',\n    strategy: 'fixed',\n    modifiers: [{ name: 'offset', options: { offset: [8, 8] } }],\n  })\n\n  useOnClickOutside(node, open ? toggle : undefined)\n\n  const selectThisList = useCallback(() => {\n    if (isSelected) return\n\n    dispatch(selectList(listUrl))\n    onBack()\n  }, [dispatch, isSelected, listUrl, onBack])\n\n  const handleAcceptListUpdate = useCallback(() => {\n    if (!pending) return\n    dispatch(acceptListUpdate(listUrl))\n  }, [dispatch, listUrl, pending])\n\n  const handleRemoveList = useCallback(() => {\n    if (window.prompt(`Please confirm you would like to remove this list by typing REMOVE`) === `REMOVE`) {\n      dispatch(removeList(listUrl))\n    }\n  }, [dispatch, listUrl])\n\n  if (!list) return null\n\n  return (\n    <Row key={listUrl} align=\"center\" padding=\"16px\" id={listUrlRowHTMLId(listUrl)}>\n      {list.logoURI ? (\n        <ListLogo style={{ marginRight: '1rem' }} logoURI={list.logoURI} alt={`${list.name} list logo`} />\n      ) : (\n        <div style={{ width: '24px', height: '24px', marginRight: '1rem' }} />\n      )}\n      <Column style={{ flex: '1' }}>\n        <Row>\n          <Text bold={isSelected} fontSize=\"16px\" style={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>\n            {list.name}\n          </Text>\n        </Row>\n        <Row\n          style={{\n            marginTop: '4px',\n          }}\n        >\n          <StyledListUrlText title={listUrl}>\n            <ListOrigin listUrl={listUrl} />\n          </StyledListUrlText>\n        </Row>\n      </Column>\n      <StyledMenu ref={node as any}>\n        <div style={{ display: 'inline-block' }} ref={setReferenceElement}>\n          <Button\n            style={{\n              width: '32px',\n              marginRight: '8px',\n            }}\n            onClick={toggle}\n            variant=\"secondary\"\n          >\n            <DropDown />\n          </Button>\n        </div>\n\n        {open && (\n          <PopoverContainer show ref={setPopperElement as any} style={styles.popper} {...attributes.popper}>\n            <div>{list && listVersionLabel(list.version)}</div>\n            <SeparatorDark />\n            <ExternalLink href={`https://tokenlists.org/token-list?url=${listUrl}`}>View list</ExternalLink>\n            <UnpaddedLinkStyledButton onClick={handleRemoveList} disabled={Object.keys(listsByUrl).length === 1}>\n              Remove list\n            </UnpaddedLinkStyledButton>\n            {pending && (\n              <UnpaddedLinkStyledButton onClick={handleAcceptListUpdate}>Update list</UnpaddedLinkStyledButton>\n            )}\n          </PopoverContainer>\n        )}\n      </StyledMenu>\n      {isSelected ? (\n        <Button disabled style={{ width: '5rem', minWidth: '5rem' }}>\n          Selected\n        </Button>\n      ) : (\n        <>\n          <Button\n            className=\"select-button\"\n            style={{\n              width: '5rem',\n              minWidth: '4.5rem',\n            }}\n            onClick={selectThisList}\n          >\n            Select\n          </Button>\n        </>\n      )}\n    </Row>\n  )\n})\n\nconst ListContainer = styled.div`\n  flex: 1;\n  overflow: auto;\n`\n\nexport function ListSelect({ onDismiss, onBack }: { onDismiss: () => void; onBack: () => void }) {\n  const [listUrlInput, setListUrlInput] = useState<string>('')\n\n  const dispatch = useDispatch<AppDispatch>()\n  const lists = useSelector<AppState, AppState['lists']['byUrl']>((state) => state.lists.byUrl)\n  const adding = Boolean(lists[listUrlInput]?.loadingRequestId)\n  const [addError, setAddError] = useState<string | null>(null)\n\n  const handleInput = useCallback((e) => {\n    setListUrlInput(e.target.value)\n    setAddError(null)\n  }, [])\n  const fetchList = useFetchListCallback()\n\n  const handleAddList = useCallback(() => {\n    if (adding) return\n    setAddError(null)\n    fetchList(listUrlInput)\n      .then(() => {\n        setListUrlInput('')\n      })\n      .catch((error) => {\n        setAddError(error.message)\n        dispatch(removeList(listUrlInput))\n      })\n  }, [adding, dispatch, fetchList, listUrlInput])\n\n  const validUrl: boolean = useMemo(() => {\n    return uriToHttp(listUrlInput).length > 0 || Boolean(parseENSAddress(listUrlInput))\n  }, [listUrlInput])\n\n  const handleEnterKey = useCallback(\n    (e) => {\n      if (validUrl && e.key === 'Enter') {\n        handleAddList()\n      }\n    },\n    [handleAddList, validUrl]\n  )\n\n  const sortedLists = useMemo(() => {\n    const listUrls = Object.keys(lists)\n    return listUrls\n      .filter((listUrl) => {\n        return Boolean(lists[listUrl].current)\n      })\n      .sort((u1, u2) => {\n        const { current: l1 } = lists[u1]\n        const { current: l2 } = lists[u2]\n        if (l1 && l2) {\n          return l1.name.toLowerCase() < l2.name.toLowerCase()\n            ? -1\n            : l1.name.toLowerCase() === l2.name.toLowerCase()\n            ? 0\n            : 1\n        }\n        if (l1) return -1\n        if (l2) return 1\n        return 0\n      })\n  }, [lists])\n\n  return (\n    <Column style={{ width: '100%', flex: '1 1' }}>\n      <PaddedColumn>\n        <RowBetween>\n          <div>\n            <ArrowLeft style={{ cursor: 'pointer' }} onClick={onBack} />\n          </div>\n          <Text fontSize=\"20px\">Manage Lists</Text>\n          <CloseIcon onClick={onDismiss} />\n        </RowBetween>\n      </PaddedColumn>\n\n      <Separator />\n\n      <PaddedColumn gap=\"14px\">\n        <Text bold>\n          Add a list{' '}\n          <QuestionHelper text=\"Token lists are an open specification for lists of BEP20 tokens. You can use any token list by entering its URL below. Beware that third party token lists can contain fake or malicious BEP20 tokens.\" />\n        </Text>\n        <Row>\n          <SearchInput\n            type=\"text\"\n            id=\"list-add-input\"\n            placeholder=\"https:// or ipfs:// or ENS name\"\n            value={listUrlInput}\n            onChange={handleInput}\n            onKeyDown={handleEnterKey}\n            style={{ height: '2.75rem', borderRadius: 12, padding: '12px' }}\n          />\n          <Button onClick={handleAddList} style={{ maxWidth: '4em', marginLeft: '1em' }} disabled={!validUrl}>\n            Add\n          </Button>\n        </Row>\n        {addError ? (\n          <Error title={addError} style={{ textOverflow: 'ellipsis', overflow: 'hidden' }} error>\n            {addError}\n          </Error>\n        ) : null}\n      </PaddedColumn>\n\n      <Separator />\n\n      <ListContainer>\n        {sortedLists.map((listUrl) => (\n          <ListRow key={listUrl} listUrl={listUrl} onBack={onBack} />\n        ))}\n      </ListContainer>\n      <Separator />\n\n      <div style={{ padding: '16px', textAlign: 'center' }}>\n        <ExternalLink href=\"https://tokenlists.org\">Browse lists</ExternalLink>\n      </div>\n    </Column>\n  )\n}\n\nexport default ListSelect\n"]},"metadata":{},"sourceType":"module"}