{"ast":null,"code":"import _slicedToArray from\"H:/XETI/YETI-AMM-DEV/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useMemo,useState}from'react';import{JSBI,Token,TokenAmount,WETH,Fraction,Percent,CurrencyAmount}from'@pancakeswap-libs/sdk';import{Button}from'@pancakeswap-libs/uikit';import{Redirect}from'react-router';import{AddressZero}from'@ethersproject/constants';import{LightCard}from'../../components/Card';import{AutoColumn}from'../../components/Column';import QuestionHelper from'../../components/QuestionHelper';import{AutoRow}from'../../components/Row';import{DEFAULT_DEADLINE_FROM_NOW}from'../../constants';import{useActiveWeb3React}from'../../hooks';import{useToken}from'../../hooks/Tokens';import{useV1ExchangeContract}from'../../hooks/useContract';import{NEVER_RELOAD,useSingleCallResult}from'../../state/multicall/hooks';import{useIsTransactionPending,useTransactionAdder}from'../../state/transactions/hooks';import{useTokenBalance,useETHBalances}from'../../state/wallet/hooks';import{BackArrow,TYPE}from'../../components/Shared';import{isAddress}from'../../utils';import{BodyWrapper}from'../AppBody';import{EmptyState}from'./EmptyState';import{V1LiquidityInfo}from'./MigrateV1Exchange';import{Dots}from'../../components/swap/styleds';import{useTotalSupply}from'../../data/TotalSupply';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Body=TYPE.body,DarkGray=TYPE.darkGray,MediumHeader=TYPE.mediumHeader,LargeHeader=TYPE.largeHeader;var WEI_DENOM=JSBI.exponentiate(JSBI.BigInt(10),JSBI.BigInt(18));var ZERO=JSBI.BigInt(0);var ONE=JSBI.BigInt(1);var ZERO_FRACTION=new Fraction(ZERO,ONE);function V1PairRemoval(_ref){var _useETHBalances;var exchangeContract=_ref.exchangeContract,liquidityTokenAmount=_ref.liquidityTokenAmount,token=_ref.token;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var totalSupply=useTotalSupply(liquidityTokenAmount.token);var exchangeETHBalance=(_useETHBalances=useETHBalances([liquidityTokenAmount.token.address]))===null||_useETHBalances===void 0?void 0:_useETHBalances[liquidityTokenAmount.token.address];var exchangeTokenBalance=useTokenBalance(liquidityTokenAmount.token.address,token);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),confirmingRemoval=_useState2[0],setConfirmingRemoval=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),pendingRemovalHash=_useState4[0],setPendingRemovalHash=_useState4[1];var shareFraction=totalSupply?new Percent(liquidityTokenAmount.raw,totalSupply.raw):ZERO_FRACTION;var ethWorth=exchangeETHBalance?CurrencyAmount.ether(exchangeETHBalance.multiply(shareFraction).multiply(WEI_DENOM).quotient):CurrencyAmount.ether(ZERO);var tokenWorth=exchangeTokenBalance?new TokenAmount(token,shareFraction.multiply(exchangeTokenBalance.raw).quotient):new TokenAmount(token,ZERO);var addTransaction=useTransactionAdder();var isRemovalPending=useIsTransactionPending(pendingRemovalHash!==null&&pendingRemovalHash!==void 0?pendingRemovalHash:undefined);var remove=useCallback(function(){if(!liquidityTokenAmount)return;setConfirmingRemoval(true);exchangeContract.removeLiquidity(liquidityTokenAmount.raw.toString(),1,// min_eth, this is safe because we're removing liquidity\n1,// min_tokens, this is safe because we're removing liquidity\nMath.floor(new Date().getTime()/1000)+DEFAULT_DEADLINE_FROM_NOW).then(function(response){addTransaction(response,{summary:\"Remove \".concat(chainId&&token.equals(WETH[chainId])?'WETH':token.symbol,\"/ETH V1 liquidity\")});setPendingRemovalHash(response.hash);}).catch(function(error){console.error(error);setConfirmingRemoval(false);});},[exchangeContract,liquidityTokenAmount,token,chainId,addTransaction]);var noLiquidityTokens=!!liquidityTokenAmount&&liquidityTokenAmount.equalTo(ZERO);var isSuccessfullyRemoved=!!pendingRemovalHash&&noLiquidityTokens;return/*#__PURE__*/_jsxs(AutoColumn,{gap:\"20px\",children:[/*#__PURE__*/_jsx(Body,{my:9,style:{fontWeight:400},children:\"This tool will remove your V1 liquidity and send the underlying assets to your wallet.\"}),/*#__PURE__*/_jsxs(LightCard,{children:[/*#__PURE__*/_jsx(V1LiquidityInfo,{token:token,liquidityTokenAmount:liquidityTokenAmount,tokenWorth:tokenWorth,ethWorth:ethWorth}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',marginTop:'1rem'},children:/*#__PURE__*/_jsx(Button,{variant:isSuccessfullyRemoved?'success':'primary',disabled:isSuccessfullyRemoved||noLiquidityTokens||isRemovalPending||confirmingRemoval,onClick:remove,children:isSuccessfullyRemoved?'Success':isRemovalPending?/*#__PURE__*/_jsx(Dots,{children:\"Removing\"}):'Remove'})})]}),/*#__PURE__*/_jsx(DarkGray,{style:{textAlign:'center'},children:\"Your Uniswap V1 \".concat(chainId&&token.equals(WETH[chainId])?'WETH':token.symbol,\"/ETH liquidity will be redeemed for underlying assets.\")})]});}export default function RemoveV1Exchange(_ref2){var _useSingleCallResult,_useSingleCallResult$;var address=_ref2.match.params.address;var validatedAddress=isAddress(address);var _useActiveWeb3React2=useActiveWeb3React(),chainId=_useActiveWeb3React2.chainId,account=_useActiveWeb3React2.account;var exchangeContract=useV1ExchangeContract(validatedAddress||undefined,true);var tokenAddress=(_useSingleCallResult=useSingleCallResult(exchangeContract,'tokenAddress',undefined,NEVER_RELOAD))===null||_useSingleCallResult===void 0?void 0:(_useSingleCallResult$=_useSingleCallResult.result)===null||_useSingleCallResult$===void 0?void 0:_useSingleCallResult$[0];var token=useToken(tokenAddress);var liquidityToken=useMemo(function(){return validatedAddress&&chainId&&token?new Token(chainId,validatedAddress,18,\"UNI-V1-\".concat(token.symbol),'Uniswap V1'):undefined;},[chainId,validatedAddress,token]);var userLiquidityBalance=useTokenBalance(account!==null&&account!==void 0?account:undefined,liquidityToken);// redirect for invalid url params\nif(!validatedAddress||tokenAddress===AddressZero){console.error('Invalid address in path',address);return/*#__PURE__*/_jsx(Redirect,{to:\"/migrate/v1\"});}return/*#__PURE__*/_jsx(BodyWrapper,{children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"16px\",children:[/*#__PURE__*/_jsxs(AutoRow,{style:{alignItems:'center',justifyContent:'space-between'},gap:\"8px\",children:[/*#__PURE__*/_jsx(BackArrow,{to:\"/migrate/v1\"}),/*#__PURE__*/_jsx(MediumHeader,{children:\"Remove V1 Liquidity\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(QuestionHelper,{text:\"Remove your Uniswap V1 liquidity tokens.\"})})]}),!account?/*#__PURE__*/_jsx(LargeHeader,{children:\"You must connect an account.\"}):userLiquidityBalance&&token&&exchangeContract?/*#__PURE__*/_jsx(V1PairRemoval,{exchangeContract:exchangeContract,liquidityTokenAmount:userLiquidityBalance,token:token}):/*#__PURE__*/_jsx(EmptyState,{message:\"Loading...\"})]})});}","map":{"version":3,"sources":["H:/XETI/YETI-AMM-DEV/src/pages/MigrateV1/RemoveV1Exchange.tsx"],"names":["React","useCallback","useMemo","useState","JSBI","Token","TokenAmount","WETH","Fraction","Percent","CurrencyAmount","Button","Redirect","AddressZero","LightCard","AutoColumn","QuestionHelper","AutoRow","DEFAULT_DEADLINE_FROM_NOW","useActiveWeb3React","useToken","useV1ExchangeContract","NEVER_RELOAD","useSingleCallResult","useIsTransactionPending","useTransactionAdder","useTokenBalance","useETHBalances","BackArrow","TYPE","isAddress","BodyWrapper","EmptyState","V1LiquidityInfo","Dots","useTotalSupply","Body","body","DarkGray","darkGray","MediumHeader","mediumHeader","LargeHeader","largeHeader","WEI_DENOM","exponentiate","BigInt","ZERO","ONE","ZERO_FRACTION","V1PairRemoval","exchangeContract","liquidityTokenAmount","token","chainId","totalSupply","exchangeETHBalance","address","exchangeTokenBalance","confirmingRemoval","setConfirmingRemoval","pendingRemovalHash","setPendingRemovalHash","shareFraction","raw","ethWorth","ether","multiply","quotient","tokenWorth","addTransaction","isRemovalPending","undefined","remove","removeLiquidity","toString","Math","floor","Date","getTime","then","response","summary","equals","symbol","hash","catch","error","console","noLiquidityTokens","equalTo","isSuccessfullyRemoved","fontWeight","display","marginTop","textAlign","RemoveV1Exchange","match","params","validatedAddress","account","tokenAddress","result","liquidityToken","userLiquidityBalance","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import React, { useCallback, useMemo, useState } from 'react'\nimport { TransactionResponse } from '@ethersproject/abstract-provider'\nimport { JSBI, Token, TokenAmount, WETH, Fraction, Percent, CurrencyAmount } from '@pancakeswap-libs/sdk'\nimport { Button } from '@pancakeswap-libs/uikit'\nimport { Redirect, RouteComponentProps } from 'react-router'\nimport { AddressZero } from '@ethersproject/constants'\nimport { Contract } from '@ethersproject/contracts'\nimport { LightCard } from '../../components/Card'\nimport { AutoColumn } from '../../components/Column'\nimport QuestionHelper from '../../components/QuestionHelper'\nimport { AutoRow } from '../../components/Row'\nimport { DEFAULT_DEADLINE_FROM_NOW } from '../../constants'\nimport { useActiveWeb3React } from '../../hooks'\nimport { useToken } from '../../hooks/Tokens'\nimport { useV1ExchangeContract } from '../../hooks/useContract'\nimport { NEVER_RELOAD, useSingleCallResult } from '../../state/multicall/hooks'\nimport { useIsTransactionPending, useTransactionAdder } from '../../state/transactions/hooks'\nimport { useTokenBalance, useETHBalances } from '../../state/wallet/hooks'\nimport { BackArrow, TYPE } from '../../components/Shared'\nimport { isAddress } from '../../utils'\nimport { BodyWrapper } from '../AppBody'\nimport { EmptyState } from './EmptyState'\nimport { V1LiquidityInfo } from './MigrateV1Exchange'\nimport { Dots } from '../../components/swap/styleds'\nimport { useTotalSupply } from '../../data/TotalSupply'\n\nconst { body: Body, darkGray: DarkGray, mediumHeader: MediumHeader, largeHeader: LargeHeader } = TYPE\n\nconst WEI_DENOM = JSBI.exponentiate(JSBI.BigInt(10), JSBI.BigInt(18))\nconst ZERO = JSBI.BigInt(0)\nconst ONE = JSBI.BigInt(1)\nconst ZERO_FRACTION = new Fraction(ZERO, ONE)\n\nfunction V1PairRemoval({\n  exchangeContract,\n  liquidityTokenAmount,\n  token,\n}: {\n  exchangeContract: Contract\n  liquidityTokenAmount: TokenAmount\n  token: Token\n}) {\n  const { chainId } = useActiveWeb3React()\n  const totalSupply = useTotalSupply(liquidityTokenAmount.token)\n  const exchangeETHBalance = useETHBalances([liquidityTokenAmount.token.address])?.[liquidityTokenAmount.token.address]\n  const exchangeTokenBalance = useTokenBalance(liquidityTokenAmount.token.address, token)\n\n  const [confirmingRemoval, setConfirmingRemoval] = useState<boolean>(false)\n  const [pendingRemovalHash, setPendingRemovalHash] = useState<string | null>(null)\n\n  const shareFraction: Fraction = totalSupply ? new Percent(liquidityTokenAmount.raw, totalSupply.raw) : ZERO_FRACTION\n\n  const ethWorth: CurrencyAmount = exchangeETHBalance\n    ? CurrencyAmount.ether(exchangeETHBalance.multiply(shareFraction).multiply(WEI_DENOM).quotient)\n    : CurrencyAmount.ether(ZERO)\n\n  const tokenWorth: TokenAmount = exchangeTokenBalance\n    ? new TokenAmount(token, shareFraction.multiply(exchangeTokenBalance.raw).quotient)\n    : new TokenAmount(token, ZERO)\n\n  const addTransaction = useTransactionAdder()\n  const isRemovalPending = useIsTransactionPending(pendingRemovalHash ?? undefined)\n\n  const remove = useCallback(() => {\n    if (!liquidityTokenAmount) return\n\n    setConfirmingRemoval(true)\n    exchangeContract\n      .removeLiquidity(\n        liquidityTokenAmount.raw.toString(),\n        1, // min_eth, this is safe because we're removing liquidity\n        1, // min_tokens, this is safe because we're removing liquidity\n        Math.floor(new Date().getTime() / 1000) + DEFAULT_DEADLINE_FROM_NOW\n      )\n      .then((response: TransactionResponse) => {\n        addTransaction(response, {\n          summary: `Remove ${chainId && token.equals(WETH[chainId]) ? 'WETH' : token.symbol}/ETH V1 liquidity`,\n        })\n        setPendingRemovalHash(response.hash)\n      })\n      .catch((error: Error) => {\n        console.error(error)\n        setConfirmingRemoval(false)\n      })\n  }, [exchangeContract, liquidityTokenAmount, token, chainId, addTransaction])\n\n  const noLiquidityTokens = !!liquidityTokenAmount && liquidityTokenAmount.equalTo(ZERO)\n\n  const isSuccessfullyRemoved = !!pendingRemovalHash && noLiquidityTokens\n\n  return (\n    <AutoColumn gap=\"20px\">\n      <Body my={9} style={{ fontWeight: 400 }}>\n        This tool will remove your V1 liquidity and send the underlying assets to your wallet.\n      </Body>\n\n      <LightCard>\n        <V1LiquidityInfo\n          token={token}\n          liquidityTokenAmount={liquidityTokenAmount}\n          tokenWorth={tokenWorth}\n          ethWorth={ethWorth}\n        />\n\n        <div style={{ display: 'flex', marginTop: '1rem' }}>\n          <Button\n            variant={isSuccessfullyRemoved ? 'success' : 'primary'}\n            disabled={isSuccessfullyRemoved || noLiquidityTokens || isRemovalPending || confirmingRemoval}\n            onClick={remove}\n          >\n            {isSuccessfullyRemoved ? 'Success' : isRemovalPending ? <Dots>Removing</Dots> : 'Remove'}\n          </Button>\n        </div>\n      </LightCard>\n      <DarkGray style={{ textAlign: 'center' }}>\n        {`Your Uniswap V1 ${\n          chainId && token.equals(WETH[chainId]) ? 'WETH' : token.symbol\n        }/ETH liquidity will be redeemed for underlying assets.`}\n      </DarkGray>\n    </AutoColumn>\n  )\n}\n\nexport default function RemoveV1Exchange({\n  match: {\n    params: { address },\n  },\n}: RouteComponentProps<{ address: string }>) {\n  const validatedAddress = isAddress(address)\n  const { chainId, account } = useActiveWeb3React()\n\n  const exchangeContract = useV1ExchangeContract(validatedAddress || undefined, true)\n  const tokenAddress = useSingleCallResult(exchangeContract, 'tokenAddress', undefined, NEVER_RELOAD)?.result?.[0]\n  const token = useToken(tokenAddress)\n\n  const liquidityToken: Token | undefined = useMemo(\n    () =>\n      validatedAddress && chainId && token\n        ? new Token(chainId, validatedAddress, 18, `UNI-V1-${token.symbol}`, 'Uniswap V1')\n        : undefined,\n    [chainId, validatedAddress, token]\n  )\n  const userLiquidityBalance = useTokenBalance(account ?? undefined, liquidityToken)\n\n  // redirect for invalid url params\n  if (!validatedAddress || tokenAddress === AddressZero) {\n    console.error('Invalid address in path', address)\n    return <Redirect to=\"/migrate/v1\" />\n  }\n\n  return (\n    <BodyWrapper>\n      <AutoColumn gap=\"16px\">\n        <AutoRow style={{ alignItems: 'center', justifyContent: 'space-between' }} gap=\"8px\">\n          <BackArrow to=\"/migrate/v1\" />\n          <MediumHeader>Remove V1 Liquidity</MediumHeader>\n          <div>\n            <QuestionHelper text=\"Remove your Uniswap V1 liquidity tokens.\" />\n          </div>\n        </AutoRow>\n\n        {!account ? (\n          <LargeHeader>You must connect an account.</LargeHeader>\n        ) : userLiquidityBalance && token && exchangeContract ? (\n          <V1PairRemoval\n            exchangeContract={exchangeContract}\n            liquidityTokenAmount={userLiquidityBalance}\n            token={token}\n          />\n        ) : (\n          <EmptyState message=\"Loading...\" />\n        )}\n      </AutoColumn>\n    </BodyWrapper>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}